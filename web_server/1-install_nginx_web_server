#!/bin/env bash

# Update package lists
apt-get update -y

# Install Nginx
apt-get install -y nginx

# Ensure Nginx is running
service nginx start

# Create a custom HTML page containing "Holberton School"
echo 'Holberton School for the win!' > /var/www/html/index.html

# Restart Nginx without using systemctl
/etc/init.d/nginx restart

# Ensure Nginx listens on port 80
if ! grep -q "listen 80;" /etc/nginx/sites-available/default; then
    echo "Error: Nginx is not properly configured to listen on port 80."
    exit 1
fi

# Confirm the setup by making a GET request to localhost
curl -s localhost | grep "Holberton School"
if [ $? -eq 0 ]; then
    echo "Nginx is serving the expected content. Setup successful."
else
    echo "Error: Nginx is not serving the expected content."
    exit 1
fi
